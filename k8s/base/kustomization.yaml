apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Namespaces
  - namespaces/namespace.yaml

  # Global config
  - config/configmap.yaml
  - config/secrets.yaml

  # Application workloads
  - apps/backend/deployment.yaml
  - apps/backend/pdb.yaml # Pod disruption budgets
  - apps/frontend/deployment.yaml

  # Databases
  - databases/postgres/deployment.yaml
  - databases/postgres/storage/postgres-pv.yaml
  - databases/postgres/storage/backup-pvc.yaml
  - databases/postgres/backup/backup-cronjob.yaml
  - databases/postgres/migrations/db-migration-job.yaml

  # Caches
  - cache/redis/statefulset.yaml

  # Cluster infra
  - infra/logging/fluentd-daemonset.yaml
  - infra/logging/fluentd-rbac.yaml
  - infra/network/network-policies.yaml
  - infra/rbac/rbac.yaml
  - infra/quotas/resource-quota.yaml

  # Pod disruption budgets
  # - pdbs/all-pdbs.yaml
